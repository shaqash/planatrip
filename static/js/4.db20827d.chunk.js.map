{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","routes/Trip.tsx"],"names":["_unsupportedIterableToArray","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","_arrayLikeToArray","arr","len","length","i","arr2","_slicedToArray","isArray","Symbol","iterator","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","unsupportedIterableToArray","TypeError","_toConsumableArray","arrayLikeToArray","iter","_defineProperty","obj","key","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread2","target","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","Trip","history","useHistory","useState","isLoading","setIsLoading","error","setError","tripData","setTripData","id","useParams","firebase","useContext","FireContext","checkbox","setCheckbox","driver","brings","drivingWith","formData","setFormData","handleFormChange","e","parseInt","replace","split","data","loadTrip","useCallback","storage","collection","doc","get","then","exists","Error","catch","message","finally","React","useEffect","className","title","participants","reduce","acc","cur","description","startDate","endDate","toDate","toLocaleDateString","formatDate","concat","getWeHave","requirements","req","itemIndex","findIndex","bring","getWeNeed","map","item","onSubmit","preventDefault","update","required","onChange","type","placeholder","state","style","visibility"],"mappings":"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","file":"static/js/4.db20827d.chunk.js","sourcesContent":["import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArrayLimit from \"@babel/runtime/helpers/esm/iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","\nimport React, { useState, useContext, useCallback } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { FireContext } from '../App';\n\ninterface TripParticipant {\n  driver: number;\n  name: string;\n  drivingWith: string;\n  brings: string[];\n};\ninterface TripType {\n  participants: TripParticipant[];\n  passphrase: string;\n  title: string;\n  description: string;\n  requirements: string[];\n  startDate: { toDate: () => Date };\n  endDate: { toDate: () => Date };\n}\n\nexport default function Trip() {\n  const history = useHistory();\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<null | string>(null);\n  const [tripData, setTripData] = useState<TripType | null>(null);\n  const { id } = useParams<{ id: string }>();\n  const firebase = useContext(FireContext);\n  const [checkbox, setCheckbox] = useState(false);\n  const [formData, setFormData] = useState<TripParticipant>({\n    name: '',\n    driver: 0,\n    brings: [],\n    drivingWith: '',\n  });\n\n  function handleFormChange(e: React.ChangeEvent<HTMLInputElement>) {\n    function parser(value: string) {\n      if (e.target.name === 'driver') return parseInt(value);\n      else if (e.target.name === 'brings') return value.replace(' ', '').split(',');\n      return value;\n    } \n    setFormData({\n      ...formData,\n      [e.target.name]: parser(e.target.value),\n    });\n  }\n\n  function calcStatus(data: TripType) {\n    const seats = data.participants.reduce((acc, cur) => acc + cur.driver - 1, 0);\n\n    return seats;\n  }\n\n  function getWeHave(data: TripType) {\n    return data.participants.reduce((acc, cur) => acc.concat(cur.brings), [] as string[]).toString();\n  }\n\n  function submit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault();\n    firebase?.storage.collection('trips').doc(id)\n      .update({ participants: tripData?.participants.concat(formData) })\n      .finally(() => history.push('/thanks'));\n  }\n\n  const loadTrip = useCallback(() => {\n    firebase?.storage.collection('trips')\n      .doc(id)\n      .get()\n      .then((doc) => {\n        if (!doc.exists) throw new Error('No such trip')\n        return doc;\n      })\n      .then((doc) => doc.data())\n      .then((tripData) => {\n        setTripData(tripData as TripType)\n      })\n      .catch((e) => setError(e.message))\n      .finally(() => setIsLoading(false));\n  }, [firebase?.storage, id]);\n\n  function getDriverTitle(participant: TripParticipant) {\n    return participant.driver > 0 ? '🚘' : '';\n  }\n\n  function formatDate(data: TripType) {\n    if (data.startDate && data.endDate)\n      return `${data.startDate.toDate().toLocaleDateString('he-IL')}-${data.endDate.toDate().toLocaleDateString('he-IL')}`;\n    return '';\n  }\n\n  function getWeNeed(data: TripType) {\n    let brings = data.participants.reduce((acc, cur) => acc.concat(cur.brings), [] as string[]);\n\n    return data.requirements.filter((req) => { \n      const itemIndex = brings.findIndex((bring) => bring === req);\n      brings = [...brings.slice(0, itemIndex), ...brings.slice(itemIndex+1)];\n      return itemIndex === -1;\n    }).toString() || 'Nothing more';\n  }\n\n  React.useEffect(() => loadTrip(), [loadTrip]);\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {isLoading ? (\n          <p>Loading..</p>\n        ) : (\n            tripData && !error ? (\n              <>\n                <span className=\"chungus\">{tripData.title}</span>\n                <span>{calcStatus(tripData)} seats left</span>\n                <p>\n                  {tripData.description}\n                  <br />\n                  {formatDate(tripData)}\n                  <br />\n                  <strong>We have</strong>: {getWeHave(tripData)}\n                  <br />\n                  <strong>We need</strong>: {getWeNeed(tripData)}\n                  <br />\n                  <strong>Going</strong>: {tripData.participants.map((item) => ` ${item.name} ${getDriverTitle(item)}`).toString()}\n                </p>\n                <form onSubmit={submit}>\n                  <div className=\"row\">\n                    <input required onChange={handleFormChange} value={formData.name} name=\"name\" type=\"text\" placeholder=\"Name\" />\n                  </div>\n                  <div className=\"row\">\n                    <input required onChange={handleFormChange} value={formData.brings} name=\"brings\" type=\"text\" placeholder={`${tripData?.requirements.slice(0, 3)}...`} />\n                  </div>\n                  <div>\n                    <span>Driver? </span>\n                    <input name=\"driver\" onChange={() => setCheckbox((state) => !state)} type=\"checkbox\" />\n                  </div>\n                  <div className=\"row\" style={{ visibility: !checkbox ? 'collapse' : 'visible' }}>\n                    <input onChange={handleFormChange} name=\"driver\" type=\"text\" value={formData.driver !== 0 ? formData.driver : ''} placeholder=\"Passengers (number)\" />\n                  </div>\n                  <div>\n                    <button type=\"submit\">You son of a bitch, I'm in! <span className=\"chungus\">👈</span></button>\n                  </div>\n                </form>\n              </>\n            ) : <p>{error ? error : 'No such trip'}</p>\n          )}\n      </header>\n    </div>\n  );\n}"],"sourceRoot":""}